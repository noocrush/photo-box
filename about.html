<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å…³äº - å†™çœŸåŒ£å­</title>
  <link rel="stylesheet" href="styles/main.css">
  <style>
    /* å…³äºé¡µç‰¹å®šæ ·å¼ */
    .about-content {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 800px;
      margin: 0 auto;
    }
    .about-section {
      margin-bottom: 30px;
    }
    .about-section h2 {
      font-size: 24px;
      margin-bottom: 15px;
      color: #333;
      border-bottom: 2px solid #3498db;
      padding-bottom: 5px;
    }
    .about-section p {
      font-size: 16px;
      line-height: 1.6;
      color: #666;
      margin-bottom: 10px;
    }
    .about-section ul {
      padding-left: 20px;
      color: #666;
    }
    .about-section li {
      margin-bottom: 8px;
      line-height: 1.6;
    }
    .version-info {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    .version-info p {
      margin: 5px 0;
    }
    .contact-info {
      background: #f0f8ff;
      padding: 15px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <script>
    // è°ƒè¯•å‡½æ•°ï¼šç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€é“¾æ¥
    function openExternalLink(url) {
      try {
        console.log('å°è¯•æ‰“å¼€é“¾æ¥:', url);
        require('electron').shell.openExternal(url);
        console.log('é“¾æ¥æ‰“å¼€æˆåŠŸ');
      } catch (error) {
        console.error('æ‰“å¼€é“¾æ¥å¤±è´¥:', error);
        alert('æ‰“å¼€é“¾æ¥å¤±è´¥: ' + error.message);
      }
    }
  </script>
  <!-- å·¦ä¾§å¯¼èˆªæ  -->
  <nav class="sidebar">
    <ul class="nav-menu">
      <li class="nav-item"><a href="index.html" class="nav-link"><span class="nav-icon">ğŸ </span> ä¸»é¡µ</a></li>
      <li class="nav-item"><a href="search.html" class="nav-link"><span class="nav-icon">ğŸ”</span> æœç´¢</a></li>
      <li class="nav-item"><a href="favorites.html" class="nav-link"><span class="nav-icon">â­</span> æ”¶è—</a></li>
      <li class="nav-item"><a href="settings.html" class="nav-link"><span class="nav-icon">âš™ï¸</span> è®¾ç½®</a></li>
      <li class="nav-item"><a href="about.html" class="nav-link active"><span class="nav-icon">â„¹ï¸</span> å…³äº</a></li>
    </ul>
  </nav>

  <div class="main-content">
    <div class="header">
      <h1>å…³äºè½¯ä»¶</h1>
    </div>

    <div class="about-content">
      <div class="about-section">
        <h2>ç‰ˆæœ¬ä¿¡æ¯</h2>
        <div class="version-info">
          <p><strong>å½“å‰ç‰ˆæœ¬ï¼š</strong><span id="current-version">1.0.0</span></p>
          <p><button id="check-update-btn" style="padding: 5px 15px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">æ£€æŸ¥æ›´æ–°</button></p>
        </div>
      </div>
      
      <div class="about-section">
        <h2>è”ç³»æ–¹å¼</h2>
        <div class="contact-info">
          <p><strong>å®˜æ–¹ä¸»é¡µï¼š</strong><button onclick="openExternalLink('https://github.com/noocrush/photo-box')" style="display: inline-block; padding: 5px 15px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-left: 10px; text-decoration: none;">è®¿é—®ä¸»é¡µ</button></p>
          <p><strong>é—®é¢˜åé¦ˆï¼š</strong><button onclick="openExternalLink('https://github.com/noocrush/photo-box/issues')" style="display: inline-block; padding: 5px 15px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-left: 10px; text-decoration: none;">æäº¤é—®é¢˜</button></p>
          <p><strong>è”ç³»é‚®ç®±ï¼š</strong>mcc83500@163.com</p>
        </div>
      </div>
    </div>
    
    <script>
      // æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬
      document.addEventListener('DOMContentLoaded', () => {
        const currentVersionElement = document.getElementById('current-version');
        if (currentVersionElement) {
          currentVersionElement.textContent = require('electron').remote.app.getVersion();
        }
        
        // æ·»åŠ æ£€æŸ¥æ›´æ–°æŒ‰é’®äº‹ä»¶
      const checkUpdateBtn = document.getElementById('check-update-btn');
      if (checkUpdateBtn) {
        checkUpdateBtn.addEventListener('click', async () => {
          checkUpdateBtn.disabled = true;
          checkUpdateBtn.textContent = 'æ£€æŸ¥ä¸­...';
          
          try {
            // ç›´æ¥åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­è·å–GitHubæœ€æ–°ç‰ˆæœ¬ä¿¡æ¯
            const response = await fetch('https://api.github.com/repos/noocrush/photo-box/releases/latest', {
              headers: {
                'User-Agent': 'PhotoManagerApp'
              }
            });
            
            if (!response.ok) {
              // å¦‚æœAPIè¿”å›é”™è¯¯çŠ¶æ€ç ï¼Œå¯èƒ½æ˜¯æ²¡æœ‰å‘å¸ƒç‰ˆæœ¬ï¼Œè§†ä¸ºå½“å‰ç‰ˆæœ¬æ˜¯æœ€æ–°çš„
              require('electron').remote.dialog.showMessageBox({
                type: 'info',
                title: 'æ£€æŸ¥æ›´æ–°',
                message: `å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ v${require('electron').remote.app.getVersion()}`,
                buttons: ['ç¡®å®š']
              });
              return;
            }
            
            const release = await response.json();
            
            // æ£€æŸ¥APIå“åº”æ˜¯å¦åŒ…å«å¿…è¦å­—æ®µ
            if (!release || !release.tag_name) {
              // å¦‚æœæ²¡æœ‰å‘å¸ƒç‰ˆæœ¬ï¼Œè§†ä¸ºå½“å‰ç‰ˆæœ¬æ˜¯æœ€æ–°çš„
              require('electron').remote.dialog.showMessageBox({
                type: 'info',
                title: 'æ£€æŸ¥æ›´æ–°',
                message: `å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ v${require('electron').remote.app.getVersion()}`,
                buttons: ['ç¡®å®š']
              });
              return;
            }
            
            const latestVersion = release.tag_name.replace('v', '');
            const releaseUrl = release.html_url || '';
            const currentVersion = require('electron').remote.app.getVersion();
            
            // æ¯”è¾ƒç‰ˆæœ¬å·
            const latestParts = latestVersion.split('.').map(Number);
            const currentParts = currentVersion.split('.').map(Number);
            let hasUpdate = false;
            
            for (let i = 0; i < Math.max(latestParts.length, currentParts.length); i++) {
              const latestVal = latestParts[i] || 0;
              const currentVal = currentParts[i] || 0;
              
              if (latestVal > currentVal) {
                hasUpdate = true;
                break;
              } else if (latestVal < currentVal) {
                break;
              }
            }
            
            if (hasUpdate) {
              const result = await require('electron').remote.dialog.showMessageBox({
                type: 'info',
                title: 'å‘ç°æ–°ç‰ˆæœ¬',
                message: `æœ‰æ–°ç‰ˆæœ¬å¯ç”¨ï¼\n\nå½“å‰ç‰ˆæœ¬: v${currentVersion}\næœ€æ–°ç‰ˆæœ¬: v${latestVersion}\n\næ›´æ–°å†…å®¹:\n${release.body || 'æ— è¯¦ç»†ä¿¡æ¯'}\n\næ˜¯å¦å‰å¾€GitHubä¸‹è½½ï¼Ÿ`,
                buttons: ['ç¨åå†è¯´', 'å‰å¾€ä¸‹è½½'],
                defaultId: 1,
                cancelId: 0
              });
              
              if (result.response === 1 && releaseUrl) {
                require('electron').shell.openExternal(releaseUrl);
              }
            } else {
              require('electron').remote.dialog.showMessageBox({
                type: 'info',
                title: 'æ£€æŸ¥æ›´æ–°',
                message: `å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ v${currentVersion}`,
                buttons: ['ç¡®å®š']
              });
            }
          } catch (error) {
            console.error('æ£€æŸ¥æ›´æ–°å¤±è´¥:', error);
            // å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¸è¦æ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡†ï¼Œè€Œæ˜¯æç¤ºå½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬
            require('electron').remote.dialog.showMessageBox({
              type: 'info',
              title: 'æ£€æŸ¥æ›´æ–°',
              message: `å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ v${require('electron').remote.app.getVersion()}`,
              buttons: ['ç¡®å®š']
            });
          } finally {
            checkUpdateBtn.disabled = false;
            checkUpdateBtn.textContent = 'æ£€æŸ¥æ›´æ–°';
          }
        });
      }
      });
    </script>
  </div>
  <script src="scripts/nav-handler.js"></script>
</body>
</html>